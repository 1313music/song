

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M3U8视频播放器</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #1e1e1e;
            color: #fff;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* 导航菜单 */
        .navbar {
            display: flex;
            justify-content: space-around;
            background: linear-gradient(45deg, #2c3e50, #1a1a1a);
            padding: 15px 0;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        
        .nav-item {
            padding: 10px 25px;
            border-radius: 8px;
            font-weight: bold;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .nav-item:hover {
            background-color: rgba(52, 152, 219, 0.3);
            transform: translateY(-2px);
        }
        
        .nav-item.active {
            background-color: #3498db;
            box-shadow: 0 0 15px rgba(52, 152, 219, 0.5);
        }
        
        /* 播放器区域 */
        .player-container {
            width: 100%;
            position: relative;
            overflow: hidden;
            padding-top: 56.25%; /* 16:9宽高比 */
            margin-bottom: 20px;
            border-radius: 8px;
            background-color: #000;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
        }
        
        #video-player {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            background: #000;
        }
        
        /* 分类导航 */
        .categories {
            display: flex;
            overflow-x: auto;
            padding: 5px 0 15px;
            margin-bottom: 10px;
            gap: 10px;
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        
        .categories::-webkit-scrollbar {
            display: none;
        }
        
        .category-btn {
            flex-shrink: 0;
            padding: 8px 15px;
            border-radius: 8px;
            background-color: #2c3e50;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 500;
        }
        
        .category-btn:hover {
            background-color: #34495e;
            transform: translateY(-2px);
        }
        
        .category-btn.active {
            background: linear-gradient(45deg, #3498db, #2980b9);
            box-shadow: 0 0 10px rgba(52, 152, 219, 0.5);
        }
        
        /* 视频列表 */
        .videos-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
            gap: 20px;
            margin-top: 10px;
        }
        
        .video-card {
            background: linear-gradient(135deg, #2c3e50, #1a1a1a);
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            position: relative;
            height: 180px;
        }
        
        .video-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(52, 152, 219, 0.4);
        }
        
        .video-card.active {
            border: 2px solid #3498db;
            box-shadow: 0 0 15px rgba(52, 152, 219, 0.8);
        }
        
        .thumbnail {
            width: 100%;
            height: 110px;
            background-color: #2c3e50;
            position: relative;
            overflow: hidden;
        }
        
        .thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        
        .video-card:hover .thumbnail img {
            transform: scale(1.05);
        }
        
        .duration {
            position: absolute;
            bottom: 5px;
            right: 5px;
            background: rgba(0, 0, 0, 0.7);
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 12px;
        }
        
        .info {
            padding: 12px;
        }
        
        .video-title {
            font-weight: 500;
            font-size: 14px;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .category-tag {
            background-color: #2980b9;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 11px;
            display: inline-block;
        }
        
        /* 错误处理 */
        .error-message {
            display: none;
            background: rgba(231, 76, 60, 0.3);
            border: 1px solid #e74c3c;
            color: #fff;
            text-align: center;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .retry-btn {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            margin-top: 15px;
        }
        
        .retry-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }
        
        /* 键盘提示 */
        .keyboard-hint {
            text-align: center;
            margin: 10px 0;
            font-size: 14px;
            color: #95a5a6;
        }
        
        /* 响应式调整 */
        @media (max-width: 768px) {
            .player-container {
                padding-top: 75%; /* 4:3移动设备比例 */
            }
            
            .videos-container {
                grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
            }
            
            .video-card {
                height: 160px;
            }
            
            .thumbnail {
                height: 90px;
            }
            
            .navbar {
                padding: 10px 0;
            }
            
            .nav-item {
                padding: 8px 15px;
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 导航菜单 -->
        <div class="navbar">
            <div class="nav-item active">音乐</div>
            <div class="nav-item">吉他谱</div>
            <div class="nav-item">公众号</div>
            <div class="nav-item">小程序</div>
        </div>
        
        <!-- 播放器区域 -->
        <div class="player-container">
            <video id="video-player" controls></video>
        </div>
        
        <!-- 分类导航 -->
        <div class="categories">
            <div class="category-btn active" data-category="all">全部</div>
            <div class="category-btn" data-category="movie">电影</div>
            <div class="category-btn" data-category="documentary">纪录片</div>
            <div class="category-btn" data-category="animation">动画</div>
            <div class="category-btn" data-category="sports">体育</div>
            <div class="category-btn" data-category="music">音乐</div>
            <div class="category-btn" data-category="education">教育</div>
        </div>
        
        <!-- 键盘提示 -->
        <div class="keyboard-hint">
            ↑↓ 键盘控制：空格键播放/暂停，左右箭头跳转，F键全屏
        </div>
        
        <!-- 错误信息 -->
        <div class="error-message" id="error-message">
            <h3>视频播放失败</h3>
            <p>视频源加载失败，请尝试重新加载或选择其他视频</p>
            <button class="retry-btn" id="retry-btn">重新加载</button>
        </div>
        
        <!-- 视频列表 -->
        <div class="videos-container" id="videos-container">
            <!-- 视频列表通过JS动态生成 -->
        </div>
    </div>

    <script>
        // 视频数据
        const videoData = [
            {
                id: 1,
                title: '风光纪录片 - 海洋奇观',
                src: 'https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8',
                category: 'documentary',
                duration: '08:45',
                thumbnail: 'https://picsum.photos/400/225?random=1'
            },
            {
                id: 2,
                title: '动画短片 - 奇幻冒险',
                src: 'https://cph-p2p-msl.akamaized.net/hls/live/2000341/test/master.m3u8',
                category: 'animation',
                duration: '06:12',
                thumbnail: 'https://picsum.photos/400/225?random=2'
            },
            {
                id: 3,
                title: '体育赛事 - 篮球锦标赛',
                src: 'https://d3rlna7iyyu8wu.cloudfront.net/skip_armstrong/skip_armstrong_stereo_subs.m3u8',
                category: 'sports',
                duration: '10:28',
                thumbnail: 'https://picsum.photos/400/225?random=3'
            },
            {
                id: 4,
                title: '音乐MV - 最新流行歌曲',
                src: 'https://test-streams.mux.dev/test_001/stream.m3u8',
                category: 'music',
                duration: '04:31',
                thumbnail: 'https://picsum.photos/400/225?random=4'
            },
            {
                id: 5,
                title: '自然探索 - 火山奥秘',
                src: 'https://d3rlna7iyyu8wu.cloudfront.net/skip_armstrong/skip_armstrong_multi_language_subs.m3u8',
                category: 'documentary',
                duration: '07:58',
                thumbnail: 'https://picsum.photos/400/225?random=5'
            },
            {
                id: 6,
                title: '教育课程 - 物理原理',
                src: 'https://multiplatform-f.akamaihd.net/i/multi/april11/sintel/sintel-hd_,512x288_450_b,640x360_700_b,768x432_1000_b,1024x576_1400_m,.mp4.csmil/master.m3u8',
                category: 'education',
                duration: '12:05',
                thumbnail: 'https://picsum.photos/400/225?random=6'
            },
            {
                id: 7,
                title: '科幻电影 - 星际探索',
                src: 'https://test-streams.mux.dev/pts_shift/master.m3u8',
                category: 'movie',
                duration: '15:36',
                thumbnail: 'https://picsum.photos/400/225?random=7'
            },
            {
                id: 8,
                title: '古典音乐会 - 钢琴协奏曲',
                src: 'https://cph-p2p-msl.akamaized.net/hls/live/2000341/test/master.m3u8',
                category: 'music',
                duration: '07:24',
                thumbnail: 'https://picsum.photos/400/225?random=8'
            }
        ];
        
        // 获取DOM元素
        const videoPlayer = document.getElementById('video-player');
        const videosContainer = document.getElementById('videos-container');
        const errorMessage = document.getElementById('error-message');
        const retryBtn = document.getElementById('retry-btn');
        const categoryBtns = document.querySelectorAll('.category-btn');
        const navItems = document.querySelectorAll('.nav-item');
        let hls;
        
        // 播放指定视频
        function playVideo(video) {
            // 重置状态
            hideError();
            
            // 移除之前的高亮
            document.querySelectorAll('.video-card.active').forEach(card => {
                card.classList.remove('active');
            });
            
            // 高亮当前视频卡片
            const currentVideoCard = document.querySelector(`.video-card[data-id="${video.id}"]`);
            if (currentVideoCard) {
                currentVideoCard.classList.add('active');
                
                // 滚动到可见位置（如果需要）
                currentVideoCard.scrollIntoView({behavior: 'smooth', block: 'center'});
            }
            
            // 处理视频源
            const videoSrc = video.src;
            
            if (videoSrc.endsWith('.m3u8')) {
                // M3U8流处理
                if (hls) {
                    hls.destroy();
                }
                
                if (Hls.isSupported()) {
                    hls = new Hls();
                    hls.loadSource(videoSrc);
                    hls.attachMedia(videoPlayer);
                    
                    hls.on(Hls.Events.MANIFEST_PARSED, () => {
                        videoPlayer.play().catch(error => {
                            console.error('播放失败:', error);
                            showError('无法自动播放视频');
                        });
                    });
                    
                    // 错误处理
                    hls.on(Hls.Events.ERROR, (event, data) => {
                        if (data.fatal) {
                            console.error('HLS错误:', data);
                            showError('视频源加载失败');
                        }
                    });
                    
                    return;
                }
            }
            
            // 其他类型视频源
            if (videoPlayer.canPlayType('application/vnd.apple.mpegurl')) {
                // 支持iOS原生HLS
                videoPlayer.src = videoSrc;
                videoPlayer.play().catch(error => {
                    console.error('播放失败:', error);
                    showError('无法自动播放视频');
                });
                return;
            }
            
            // 不支持HLS
            showError('当前浏览器不支持HLS视频格式');
        }
        
        // 显示错误消息
        function showError(message = null) {
            if (message) {
                errorMessage.querySelector('p').textContent = message;
            }
            errorMessage.style.display = 'block';
        }
        
        // 隐藏错误消息
        function hideError() {
            errorMessage.style.display = 'none';
        }
        
        // 加载视频列表
        function loadVideoList(category = 'all') {
            videosContainer.innerHTML = '';
            
            const filteredVideos = category === 'all' 
                ? videoData 
                : videoData.filter(v => v.category === category);
            
            if (filteredVideos.length === 0) {
                videosContainer.innerHTML = `<div class="no-results">当前分类没有视频内容</div>`;
                return;
            }
            
            filteredVideos.forEach(video => {
                const videoCard = document.createElement('div');
                videoCard.className = 'video-card';
                videoCard.dataset.id = video.id;
                
                videoCard.innerHTML = `
                    <div class="thumbnail">
                        <img src="${video.thumbnail}" alt="${video.title}">
                        <div class="duration">${video.duration}</div>
                    </div>
                    <div class="info">
                        <div class="video-title">${video.title}</div>
                        <div class="category-tag">${video.category}</div>
                    </div>
                `;
                
                videoCard.addEventListener('click', () => {
                    playVideo(video);
                });
                
                videosContainer.appendChild(videoCard);
            });
        }
        
        // 初始化页面
        function initialize() {
            // 加载第一个视频
            if (videoData.length > 0) {
                playVideo(videoData[0]);
            }
            
            // 加载视频列表
            loadVideoList();
            
            // 绑定分类切换事件
            categoryBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    // 移除之前的高亮
                    categoryBtns.forEach(b => b.classList.remove('active'));
                    // 添加当前高亮
                    btn.classList.add('active');
                    // 加载新分类的视频
                    loadVideoList(btn.dataset.category);
                });
            });
            
            // 导航菜单点击事件
            navItems.forEach(item => {
                item.addEventListener('click', () => {
                    // 移除之前的高亮
                    navItems.forEach(nav => nav.classList.remove('active'));
                    // 添加当前高亮
                    item.classList.add('active');
                    
                    // 这里可以添加每个导航项的功能
                    alert('导航功能: ' + item.textContent);
                });
            });
            
            // 绑定重试按钮事件
            retryBtn.addEventListener('click', () => {
                hideError();
                if (videoData.length > 0) {
                    playVideo(videoData[0]);
                }
            });
            
            // 键盘快捷键
            document.addEventListener('keydown', (e) => {
                switch (e.key) {
                    case ' ':
                        videoPlayer.paused ? videoPlayer.play() : videoPlayer.pause();
                        break;
                    case 'ArrowLeft':
                        videoPlayer.currentTime = Math.max(0, videoPlayer.currentTime - 5);
                        break;
                    case 'ArrowRight':
                        videoPlayer.currentTime = Math.min(videoPlayer.duration, videoPlayer.currentTime + 5);
                        break;
                    case 'f':
                    case 'F':
                        if (videoPlayer.requestFullscreen) {
                            videoPlayer.requestFullscreen();
                        } else if (videoPlayer.webkitRequestFullscreen) {
                            videoPlayer.webkitRequestFullscreen();
                        }
                        break;
                }
            });
        }
        
        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', initialize);
    </script>
</body>
</html>
